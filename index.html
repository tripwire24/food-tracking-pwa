<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AI-powered food tracking app with nutrition analysis">
    <meta name="theme-color" content="#2E7D32">
    
    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Food Tracker">
    <meta name="msapplication-TileColor" content="#2E7D32">
    <meta name="msapplication-config" content="/browserconfig.xml">
    
    <!-- Favicon and Icons -->
    <link rel="icon" type="image/svg+xml" sizes="32x32" href="./public/icons/favicon-32x32.svg">
    <link rel="icon" type="image/svg+xml" sizes="16x16" href="./public/icons/favicon-16x16.svg">
    <link rel="apple-touch-icon" sizes="180x180" href="./public/icons/apple-touch-icon.svg">
    <link rel="mask-icon" href="./public/icons/icon-192x192.svg" color="#2E7D32">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="./manifest.json">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="./src/css/modern.css">
    
    <title>Food Tracker - AI Nutrition Analysis</title>
</head>
<body>
    <!-- App Shell -->
    <div id="app" class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <div class="app-logo">
                    <svg class="logo-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M11,9H9V2H7V9H5V2H3V9C3,11.12 4.66,12.84 6.75,12.97L6,22H9L8.25,12.97C10.34,12.84 12,11.12 12,9V2H10V9M16,6V14H18.5V22H21.5V14H24V6H16Z"/>
                    </svg>
                    <span class="app-name">NutriTrack</span>
                </div>
                <button id="profile-btn" class="profile-btn">
                    <svg viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z"/>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Bottom Navigation Bar (Mobile First) -->
        <nav id="bottom-nav" class="bottom-nav">
            <button class="nav-item active" data-page="home">
                <svg class="nav-icon" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                </svg>
                <span class="nav-label">Home</span>
            </button>
            <button class="nav-item" data-page="capture">
                <svg class="nav-icon" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                </svg>
                <span class="nav-label">Capture</span>
            </button>
            <button class="nav-item nav-fab" data-page="capture">
                <svg class="fab-icon" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/>
                </svg>
            </button>
            <button class="nav-item" data-page="dashboard">
                <svg class="nav-icon" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/>
                </svg>
                <span class="nav-label">Stats</span>
            </button>
            <button class="nav-item" data-page="history">
                <svg class="nav-icon" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M13 3c-4.97 0-9 4.03-9 9H1l3.89 3.89.07.14L9 12H6c0-3.87 3.13-7 7-7s7 3.13 7 7-3.13 7-7 7c-1.93 0-3.68-.79-4.94-2.06l-1.42 1.42C8.27 19.99 10.51 21 13 21c4.97 0 9-4.03 9-9s-4.03-9-9-9zm-1 5v5l4.28 2.54.72-1.21-3.5-2.08V8H12z"/>
                </svg>
                <span class="nav-label">History</span>
            </button>
        </nav>

        <!-- Main Content Area -->
        <main id="main-content" class="main-content">
            <!-- Home Page -->
            <section id="home-page" class="page active">
                <div class="welcome-section">
                    <h1 class="welcome-title">Track Your Nutrition</h1>
                    <p class="welcome-subtitle">Smart food analysis powered by AI</p>
                    
                    <div class="quick-actions">
                        <button id="quick-capture-btn" class="btn btn-primary">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"/>
                            </svg>
                            Quick Capture
                        </button>
                        <button id="view-dashboard-btn" class="btn btn-secondary">
                            View Stats
                        </button>
                    </div>
                </div>

                <div class="card">
                    <h3 class="result-header">Today's Progress</h3>
                    <div class="summary-grid">
                        <div class="summary-card">
                            <div class="card-icon">
                                <svg viewBox="0 0 24 24" fill="#5B21B6">
                                    <path d="M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z"/>
                                </svg>
                            </div>
                            <div class="card-value" id="today-calories">0</div>
                            <div class="card-label">Calories</div>
                        </div>
                        <div class="summary-card">
                            <div class="card-icon" style="background: #FEE2E2;">
                                <svg viewBox="0 0 24 24" fill="#EF4444">
                                    <path d="M19,3H5C3.89,3 3,3.9 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M19,19H5V5H19V19M17,8.4L13.4,12L17,15.6L15.6,17L12,13.4L8.4,17L7,15.6L10.6,12L7,8.4L8.4,7L12,10.6L15.6,7L17,8.4Z"/>
                                </svg>
                            </div>
                            <div class="card-value" id="today-protein">0g</div>
                            <div class="card-label">Protein</div>
                        </div>
                        <div class="summary-card">
                            <div class="card-icon" style="background: #FEF3C7;">
                                <svg viewBox="0 0 24 24" fill="#F59E0B">
                                    <path d="M12,2L4,7V12.5C4,18.5 8.92,20.74 11.1,21.5C11.35,21.6 11.55,21.68 11.71,21.74C11.78,21.77 11.85,21.79 11.91,21.82C11.94,21.83 11.97,21.84 12,21.84V2Z"/>
                                </svg>
                            </div>
                            <div class="card-value" id="today-carbs">0g</div>
                            <div class="card-label">Carbs</div>
                        </div>
                        <div class="summary-card">
                            <div class="card-icon" style="background: #D1FAE5;">
                                <svg viewBox="0 0 24 24" fill="#10B981">
                                    <path d="M12,2A3,3 0 0,1 15,5V11A3,3 0 0,1 12,14A3,3 0 0,1 9,11V5A3,3 0 0,1 12,2M19,11C19,14.53 16.39,17.44 13,17.93V21H11V17.93C7.61,17.44 5,14.53 5,11H7A5,5 0 0,0 12,16A5,5 0 0,0 17,11H19Z"/>
                                </svg>
                            </div>
                            <div class="card-value" id="today-fat">0g</div>
                            <div class="card-label">Fat</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Food Capture Page -->
            <section id="capture-page" class="page">
                <div class="capture-container">
                    <h2 class="welcome-title">Add Food</h2>
                    
                    <div class="capture-options">
                        <button id="camera-btn" class="capture-btn">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M4,4H7L9,2H15L17,4H20A2,2 0 0,1 22,6V18A2,2 0 0,1 20,20H4A2,2 0 0,1 2,18V6A2,2 0 0,1 4,4M12,7A5,5 0 0,0 7,12A5,5 0 0,0 12,17A5,5 0 0,0 17,12A5,5 0 0,0 12,7M12,9A3,3 0 0,1 15,12A3,3 0 0,1 12,15A3,3 0 0,1 9,12A3,3 0 0,1 12,9Z"/>
                            </svg>
                            <span>Camera</span>
                        </button>
                        <button id="upload-btn" class="capture-btn">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M9,16V10H5L12,3L19,10H15V16H9M5,20V18H19V20H5Z"/>
                            </svg>
                            <span>Upload</span>
                        </button>
                        <button id="text-input-btn" class="capture-btn">
                            <svg viewBox="0 0 24 24" fill="currentColor">
                                <path d="M19,10H20A2,2 0 0,1 22,12V17A2,2 0 0,1 20,19H4A2,2 0 0,1 2,17V12A2,2 0 0,1 4,10H5V9A7,7 0 0,1 12,2A7,7 0 0,1 19,9V10M12,4A5,5 0 0,0 7,9V10H17V9A5,5 0 0,0 12,4Z"/>
                            </svg>
                            <span>Text</span>
                        </button>
                    </div>

                    <div id="capture-area" class="capture-area">
                        <!-- Dynamic content for camera, upload, or text input -->
                    </div>

                    <div id="analysis-results" class="analysis-results hidden">
                        <!-- AI analysis results will appear here -->
                    </div>
                </div>
            </section>

            <!-- Dashboard Page -->
            <section id="dashboard-page" class="page">
                <div class="dashboard-container">
                    <h2>Nutrition Dashboard 📊</h2>
                    
                    <div class="dashboard-grid">
                        <div class="chart-widget">
                            <h3>Weekly Calories</h3>
                            <canvas id="calories-chart"></canvas>
                        </div>
                        
                        <div class="chart-widget">
                            <h3>Macronutrient Breakdown</h3>
                            <canvas id="macros-chart"></canvas>
                        </div>
                        
                        <div class="chart-widget">
                            <h3>Daily Progress</h3>
                            <div id="progress-bars">
                                <!-- Progress bars for daily goals -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- History Page -->
            <section id="history-page" class="page">
                <div class="history-container">
                    <h2>Food History 📋</h2>
                    
                    <div class="history-filters">
                        <select id="time-filter">
                            <option value="today">Today</option>
                            <option value="week">This Week</option>
                            <option value="month">This Month</option>
                            <option value="all">All Time</option>
                        </select>
                    </div>

                    <div id="history-list" class="history-list">
                        <!-- Historical food entries will appear here -->
                    </div>
                </div>
            </section>

            <!-- Settings Page -->
            <section id="settings-page" class="page">
                <div class="settings-container">
                    <h2>Settings ⚙️</h2>
                    
                    <div class="settings-group">
                        <h3>Nutrition Goals</h3>
                        <div class="setting-item">
                            <label for="calorie-goal">Daily Calorie Goal</label>
                            <input type="number" id="calorie-goal" value="2000">
                        </div>
                        <div class="setting-item">
                            <label for="protein-goal">Protein Goal (g)</label>
                            <input type="number" id="protein-goal" value="150">
                        </div>
                        <div class="setting-item">
                            <label for="carb-goal">Carb Goal (g)</label>
                            <input type="number" id="carb-goal" value="200">
                        </div>
                        <div class="setting-item">
                            <label for="fat-goal">Fat Goal (g)</label>
                            <input type="number" id="fat-goal" value="70">
                        </div>
                    </div>

                    <div class="settings-group">
                        <h3>App Preferences</h3>
                        <div class="setting-item">
                            <label>
                                <input type="checkbox" id="offline-mode"> Enable Offline Mode
                            </label>
                        </div>
                        <div class="setting-item">
                            <label>
                                <input type="checkbox" id="notifications"> Enable Notifications
                            </label>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Loading Overlay -->
        <div id="loading-overlay" class="loading-overlay hidden">
            <div class="spinner"></div>
            <p>Analyzing your food...</p>
        </div>

        <!-- Camera Modal -->
        <div id="camera-modal" class="modal hidden">
            <div class="modal-content">
                <span class="close">&times;</span>
                <video id="camera-video" autoplay playsinline></video>
                <canvas id="camera-canvas" style="display: none;"></canvas>
                <button id="capture-photo-btn" class="primary-btn">Capture</button>
            </div>
        </div>
    </div>

    <!-- Hidden file input for image upload -->
    <input type="file" id="file-input" accept="image/*" style="display: none;">

    <!-- Scripts -->
    <script src="./src/js/utils.js"></script>
    <script src="./src/js/storage.js"></script>
    <script src="./src/js/nutrition-api.js"></script>
    <script src="./src/js/ai-vision.js"></script>
    <script src="./src/js/app-modern.js"></script>

    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then((registration) => {
                        console.log('SW registered: ', registration);
                    })
                    .catch((registrationError) => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>
</html>