<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="AI-powered food tracking app with nutrition analysis">
    <meta name="theme-color" content="#2E7D32">
    
    <!-- PWA Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Food Tracker">
    <meta name="msapplication-TileColor" content="#2E7D32">
    <meta name="msapplication-config" content="/browserconfig.xml">
    
    <!-- Favicon and Icons -->
    <link rel="icon" type="image/svg+xml" sizes="32x32" href="./public/icons/favicon-32x32.svg">
    <link rel="icon" type="image/svg+xml" sizes="16x16" href="./public/icons/favicon-16x16.svg">
    <link rel="apple-touch-icon" sizes="180x180" href="./public/icons/apple-touch-icon.svg">
    <link rel="mask-icon" href="./public/icons/icon-192x192.svg" color="#2E7D32">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="./manifest.json">
    
    <!-- Stylesheets -->
    <link rel="stylesheet" href="./src/css/main.css">
    <link rel="stylesheet" href="./src/css/components.css">
    <link rel="stylesheet" href="./src/css/responsive.css">
    
    <title>Food Tracker - AI Nutrition Analysis</title>
</head>
<body>
    <!-- App Shell -->
    <div id="app" class="app-container">
        <!-- Header -->
        <header class="app-header">
            <div class="header-content">
                <h1 class="app-title">üçΩÔ∏è Food Tracker</h1>
                <button id="menu-btn" class="menu-btn" aria-label="Menu">
                    <span></span>
                    <span></span>
                    <span></span>
                </button>
            </div>
        </header>

        <!-- Navigation -->
        <nav id="nav-menu" class="nav-menu hidden">
            <ul class="nav-list">
                <li><a href="#home" class="nav-link active" data-page="home">üè† Home</a></li>
                <li><a href="#capture" class="nav-link" data-page="capture">üì∏ Capture Food</a></li>
                <li><a href="#dashboard" class="nav-link" data-page="dashboard">üìä Dashboard</a></li>
                <li><a href="#history" class="nav-link" data-page="history">üìã History</a></li>
                <li><a href="#settings" class="nav-link" data-page="settings">‚öôÔ∏è Settings</a></li>
            </ul>
        </nav>

        <!-- Main Content Area -->
        <main id="main-content" class="main-content">
            <!-- Home Page -->
            <section id="home-page" class="page active">
                <div class="welcome-section">
                    <h2>Welcome to Your Food Journey! üåü</h2>
                    <p>Track your nutrition with AI-powered food recognition</p>
                    
                    <div class="quick-actions">
                        <button id="quick-capture-btn" class="primary-btn">
                            üì∏ Quick Capture
                        </button>
                        <button id="view-dashboard-btn" class="secondary-btn">
                            üìä View Dashboard
                        </button>
                    </div>
                </div>

                <div class="today-summary">
                    <h3>Today's Summary</h3>
                    <div class="summary-cards">
                        <div class="summary-card">
                            <div class="card-value" id="today-calories">0</div>
                            <div class="card-label">Calories</div>
                        </div>
                        <div class="summary-card">
                            <div class="card-value" id="today-protein">0g</div>
                            <div class="card-label">Protein</div>
                        </div>
                        <div class="summary-card">
                            <div class="card-value" id="today-carbs">0g</div>
                            <div class="card-label">Carbs</div>
                        </div>
                        <div class="summary-card">
                            <div class="card-value" id="today-fat">0g</div>
                            <div class="card-label">Fat</div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Food Capture Page -->
            <section id="capture-page" class="page">
                <div class="capture-container">
                    <h2>Capture Your Food üì∏</h2>
                    
                    <div class="capture-options">
                        <button id="camera-btn" class="capture-btn">
                            üì∑ Take Photo
                        </button>
                        <button id="upload-btn" class="capture-btn">
                            üñºÔ∏è Upload Image
                        </button>
                        <button id="text-input-btn" class="capture-btn">
                            ‚úçÔ∏è Describe Food
                        </button>
                    </div>

                    <div id="capture-area" class="capture-area">
                        <!-- Dynamic content for camera, upload, or text input -->
                    </div>

                    <div id="analysis-results" class="analysis-results hidden">
                        <!-- AI analysis results will appear here -->
                    </div>
                </div>
            </section>

            <!-- Dashboard Page -->
            <section id="dashboard-page" class="page">
                <div class="dashboard-container">
                    <h2>Nutrition Dashboard üìä</h2>
                    
                    <div class="dashboard-grid">
                        <div class="chart-widget">
                            <h3>Weekly Calories</h3>
                            <canvas id="calories-chart"></canvas>
                        </div>
                        
                        <div class="chart-widget">
                            <h3>Macronutrient Breakdown</h3>
                            <canvas id="macros-chart"></canvas>
                        </div>
                        
                        <div class="chart-widget">
                            <h3>Daily Progress</h3>
                            <div id="progress-bars">
                                <!-- Progress bars for daily goals -->
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- History Page -->
            <section id="history-page" class="page">
                <div class="history-container">
                    <h2>Food History üìã</h2>
                    
                    <div class="history-filters">
                        <select id="time-filter">
                            <option value="today">Today</option>
                            <option value="week">This Week</option>
                            <option value="month">This Month</option>
                            <option value="all">All Time</option>
                        </select>
                    </div>

                    <div id="history-list" class="history-list">
                        <!-- Historical food entries will appear here -->
                    </div>
                </div>
            </section>

            <!-- Settings Page -->
            <section id="settings-page" class="page">
                <div class="settings-container">
                    <h2>Settings ‚öôÔ∏è</h2>
                    
                    <div class="settings-group">
                        <h3>Nutrition Goals</h3>
                        <div class="setting-item">
                            <label for="calorie-goal">Daily Calorie Goal</label>
                            <input type="number" id="calorie-goal" value="2000">
                        </div>
                        <div class="setting-item">
                            <label for="protein-goal">Protein Goal (g)</label>
                            <input type="number" id="protein-goal" value="150">
                        </div>
                        <div class="setting-item">
                            <label for="carb-goal">Carb Goal (g)</label>
                            <input type="number" id="carb-goal" value="200">
                        </div>
                        <div class="setting-item">
                            <label for="fat-goal">Fat Goal (g)</label>
                            <input type="number" id="fat-goal" value="70">
                        </div>
                    </div>

                    <div class="settings-group">
                        <h3>App Preferences</h3>
                        <div class="setting-item">
                            <label>
                                <input type="checkbox" id="offline-mode"> Enable Offline Mode
                            </label>
                        </div>
                        <div class="setting-item">
                            <label>
                                <input type="checkbox" id="notifications"> Enable Notifications
                            </label>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Loading Overlay -->
        <div id="loading-overlay" class="loading-overlay hidden">
            <div class="spinner"></div>
            <p>Analyzing your food...</p>
        </div>

        <!-- Camera Modal -->
        <div id="camera-modal" class="modal hidden">
            <div class="modal-content">
                <span class="close">&times;</span>
                <video id="camera-video" autoplay playsinline></video>
                <canvas id="camera-canvas" style="display: none;"></canvas>
                <button id="capture-photo-btn" class="primary-btn">Capture</button>
            </div>
        </div>
    </div>

    <!-- Hidden file input for image upload -->
    <input type="file" id="file-input" accept="image/*" style="display: none;">

    <!-- Scripts -->
    <script src="./src/js/utils.js"></script>
    <script src="./src/js/storage.js"></script>
    <script src="./src/js/camera.js"></script>
    <script src="./src/js/ai-vision.js"></script>
    <script src="./src/js/nutrition.js"></script>
    <script src="./src/js/dashboard.js"></script>
    <script src="./src/components/camera-modal.js"></script>
    <script src="./src/components/food-entry.js"></script>
    <script src="./src/components/chart-widgets.js"></script>
    <script src="./src/js/app.js"></script>

    <!-- App Initialization -->
    <script>
        // Initialize the Food Tracker App
        let foodTrackerApp;
        
        document.addEventListener('DOMContentLoaded', () => {
            foodTrackerApp = new FoodTrackerApp();
            window.foodTrackerApp = foodTrackerApp; // Make it globally accessible
        });
    </script>
    
    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then((registration) => {
                        console.log('SW registered: ', registration);
                    })
                    .catch((registrationError) => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>
</body>
</html>